hmLoadTopic({
hmKeywords:"",
hmTitle:"Blob storage structure",
hmDescription:"Azure Blob storage is a cheap storage space that can hold a nearly unlimited amount of data, however it is not a database that can be used to extensively search and filter for...",
hmPrevLink:"impr-raw-data-storage.html",
hmNextLink:"impr-blob-contents.html",
hmParentLink:"impr-raw-data-storage.html",
hmBreadCrumbs:"<a href=\"backend-infrastructure.html\">Backend infrastructure<\/a> &gt; <a href=\"impr.html\">IoT Message Processing<\/a> &gt; <a href=\"impr-raw-data-storage.html\">Raw data storage<\/a>",
hmTitlePath:"Backend infrastructure > IoT Message Processing > Raw data storage > Blob storage structure",
hmHeader:"<h1 class=\"p_Heading1\"><span class=\"f_Heading1\">Blob storage structure<\/span><\/h1>\n\r",
hmBody:"<p class=\"p_Normal\">Azure Blob storage is a cheap storage space that can hold a nearly unlimited amount of data, however it is not a database that can be used to extensively search and filter for messages. Therefore the structure how blobs are organized is crucial for building a valuable data storage.<\/p>\n\r<p class=\"p_Normal\">Figure 8 shows the virtual file system structure used by HsM to structure blobs in the Raw Data Storage.  43 describes the parts of this virtual file system structure. Note that - based on the configuration of the processing function - messages can be stored duplicated in in the <span class=\"f_InlineCode\">datebased<\/span> and <span class=\"f_InlineCode\">denderbased<\/span> virtual folders.<\/p>\n\r<p class=\"p_Normal\"><img alt=\"impr-rawdatastorage-virtual-structure\" style=\"margin:0;width:34.1250rem;height:24.8125rem;border:none\" src=\".\/images\/impr-rawdatastorage-virtual-structure.png\"\/><\/p>\n\r<p class=\"p_Normal\"><a id=\"fig_1bb563\" class=\"hmanchor\"><\/a><span class=\"f_ImageCaption\">Figure 8: &nbsp;The virtual file system structure used in the Raw Data Blob Storage container. <\/span><\/p>\n\r<p class=\"p_Normal\">&nbsp;<\/p>\n\r<div style=\"text-align: left; text-indent: 0; line-height: 1.44; padding: 0 0 0 0; margin: 0.3750rem 0 0.2500rem 0;\"><table style=\"width:43.7500rem; border:none; border-spacing:0; border-collapse:collapse;\">\n\r<thead>\n\r<tr>\n\r<th style=\"vertical-align:top; width:7.1875rem; background-color:#F5F5F5; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_Normal\">Part<\/p>\n\r<\/th>\n\r<th style=\"vertical-align:top; width:35.8750rem; background-color:#F5F5F5; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_Normal\">Description<\/p>\n\r<\/th>\n\r<\/tr>\n\r<\/thead>\n\r<tbody>\n\r<tr>\n\r<td style=\"vertical-align:top; width:7.1875rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_InlineCode\"><span class=\"f_InlineCode\">&lt;MessageType&gt;<\/span><\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:35.8750rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_Normal\">Each message type used to send data to the HsM Azure IoT Hub has a specific name that is used as the top level virtual folder in this virtual file system. <\/p>\n\r<p class=\"p_CondensedNormal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_InlineCode\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span><span class=\"f_CondensedNormal\"><a href=\"impr-messagetype-resource-instance-data.html\" class=\"topiclink\">resource instance data<\/a>: <\/span><span class=\"f_InlineCode\">resourceinstancedata<\/span><\/p><p class=\"p_CondensedNormal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_InlineCode\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span><span class=\"f_CondensedNormal\"><a href=\"impr-messagetype-gateway-heartbeat.html\" class=\"topiclink\">gateway heartbeat<\/a>: <\/span><span class=\"f_InlineCode\">gatewayheartbeat<\/span><\/p><p class=\"p_CondensedNormal\" style=\"text-indent: 0; padding-left: 0.8125rem; margin-left: 0;\"><span class=\"f_InlineCode\" style=\"font-family: Arial,\'Lucida Sans Unicode\',\'Lucida Grande\',\'Lucida Sans\';display:inline-block;width:0.8125rem;margin-left:-0.8125rem\">&#8226;<\/span><span class=\"f_CondensedNormal\"><a href=\"impr-messagetype-device-gateway-connection-status.html\" class=\"topiclink\">device-gateway connection status<\/a>: <\/span><span class=\"f_InlineCode\">devicegatewayconnectionstatus<\/span><\/p><p class=\"p_Normal\">Note that different versions of the same message type will still be stored in the same virtual folder, so you cannot expect only one syntactical format within one <span class=\"f_InlineCode\">MessageType<\/span> folder.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:7.1875rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_InlineCode\"><span class=\"f_InlineCode\">DateBased<\/span><\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:35.8750rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_Normal\">This virtual folder is the root for a sub-structure that stores messages strictly structured by the date at which they arrived on the IoT Hub. Messages in this sub-structure may have duplicates in the Sender-Based sub-structure.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:7.1875rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_InlineCode\"><span class=\"f_InlineCode\">SenderBased<\/span><\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:35.8750rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_Normal\">This virtual folder is the root for a sub-structure that stores messages structured first by id of the sender and then by the date at which they arrived on the IoT Hub. This substructure is only written if the processing function is configured to do so. Messages in this sub-structure will always have duplicates in the Date-Based sub-structure.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:7.1875rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_InlineCode\"><span class=\"f_InlineCode\">&lt;Year&gt;<\/span><\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:35.8750rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_Normal\">Year of the time-instant when the message was persisted to the blob storage, encoded as 4 digits (.NET date format string: <span class=\"f_InlineCode\">yyyy<\/span>).<\/p>\n\r<div style=\"text-align: left; text-indent: 0; line-height: 1.44; padding: 0 0 0 0; margin: 0.3750rem 0 0.2500rem 0;\"><table class=\"BoxImportant\" >\n\r<tr class=\"BoxImportant\">\n\r<td class=\"BoxImportant\"><p class=\"p_Normal\"><span style=\"font-weight: bold;\">Note<\/span>: The time-instant for creating the storage structure is the current date and time evaluated by the <a href=\"impr-func-iot-routing-rvs.html\" class=\"topiclink\">func-iot-routing-rvs<\/a> expressed in UTC<\/p>\n\r<\/td>\n\r<\/tr>\n\r<\/table>\n\r<\/div>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:7.1875rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_InlineCode\"><span class=\"f_InlineCode\">&lt;Month&gt;<\/span><\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:35.8750rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_Normal\">Month of the time-instant when the message was persisted to the blob storage, encoded as 2 digits with leading zeros if necessary. (.NET date format string: <span class=\"f_InlineCode\">MM<\/span>).<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:7.1875rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_InlineCode\"><span class=\"f_InlineCode\">&lt;Day&gt;<\/span><\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:35.8750rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_Normal\">Day of the time-instant when the message was persisted to the blob storage, encoded as 2 digits with leading zeros if necessary. (.NET date format string: <span class=\"f_InlineCode\">dd<\/span>).<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:7.1875rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_InlineCode\"><span class=\"f_InlineCode\">&lt;Hour&gt;<\/span><\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:35.8750rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_Normal\">Hour of the time-instant when the message was persisted to the blob storage, encoded as 2 digits hour on a 24h clock with leading zeros if necessary (.NET date format string: <span class=\"f_InlineCode\">HH<\/span>).<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:7.1875rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_InlineCode\"><span class=\"f_InlineCode\">&lt;Minute&gt;<\/span><\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:35.8750rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_Normal\">Minute of the time-instant when the message was persisted to the blob storage, encoded as 2 digits hour on a 24h clock with leading zeros if necessary (.NET date format string: <span class=\"f_InlineCode\">mm<\/span>).<\/p>\n\r<\/td>\n\r<\/tr>\n\r<tr>\n\r<td style=\"vertical-align:top; width:7.1875rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_InlineCode\"><span class=\"f_InlineCode\">&lt;MillisecondsInMinute&gt;<\/span><\/p>\n\r<\/td>\n\r<td style=\"vertical-align:top; width:35.8750rem; padding:0.1250rem; border:solid thin #e1e1e1;\"><p class=\"p_Normal\">Milliseconds from start of minute of the time-instant when the message was persisted to the blob storage, encoded 5 digits number with leading zeros e.g. <span class=\"f_InlineCode\">09005<\/span> would be the 9th second of the minute and 5 milliseconds.<\/p>\n\r<\/td>\n\r<\/tr>\n\r<\/tbody>\n\r<\/table>\n\r<\/div>\n\r<p class=\"p_ImageCaption\"><a id=\"fig_860b26\" class=\"hmanchor\"><\/a><span class=\"f_ImageCaption\">Table 43: Parts of the parts of the raw data storage structure<\/span><\/p>\n\r"
})
